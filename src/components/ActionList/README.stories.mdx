import { Meta, Story, Canvas, ArgsTable, Source, Preview } from '@storybook/addon-docs';
import dedent from 'ts-dedent';

import { ActionList, Button, Popover, Icon } from '@/polaris-vue';
import ExportMinor from '@icons/ExportMinor.svg';
import ImportMinor from '@icons/ImportMinor.svg';
import EditMinor from '@icons/EditMinor.svg';
import DeleteMinor from '@icons/DeleteMinor.svg';
import TickSmallMinor from '@icons/TickSmallMinor.svg';
import ChevronRightMinor from '@icons/ChevronRightMinor.svg';

<Meta
  title="Components / Actions / ActionList"
  component={ ActionList }
  argTypes={{
    items: {
      name: 'items',
      control: {
        type: 'object',
      },
      defaultValue: [
        {
          content: 'Import file',
        },
        {
          content: 'Export file',
        },
      ],
      table: {
        type: {
          summary: null,
        },
      },
    },
    actionRole: {
      control: {
        type: 'select',
        options: ['menuitem'],
      },
      table: {
        type: {
          summary: null,
        },
      },
    },
    'action-any-item': {
      name: 'action-any-item',
      description: 'Callback when any item is clicked or keypressed',
      control: { disable: true },
      table: {
        type: {
          summary: '"() => void"',
        },
      },
    },
    prefix: {
      name: 'prefix-${prefixId}',
      description: 'Slot to custom prefix for each item of ActionList by `prefixId`',
      control: { disable: true },
      table: {
        category: 'Slots',
        type: {
          summary: null,
        },
      },
    },
    suffix: {
      name: 'suffix-${suffixId}',
      description: 'Slot to custom suffix for each item of ActionList by `suffixId`',
      control: { disable: true },
      table: {
        category: 'Slots',
        type: {
          summary: null,
        },
      },
    },
    default: {
      table: {
        disable: 'true',
      }
    },
  }}
/>

export const Template = (args, { argTypes }) => ({
  props: Object.keys(argTypes),
  components: { ActionList },
  template: `<div :style="{width: '200px', background: '#f6f6f7'}" data-style="{width: '200px', background: '#f6f6f7'}">
    <ActionList v-bind="$props"></ActionList>
  </div>`,
});

export const inAPopover = (args, { argTypes }) => ({
  components: { ActionList, Button, Popover },
  data() {
    return {
      active: false,
      items: [
        {
          content: 'Import file',
          onAction: this.handleImportedAction,
        },
        {
          content: 'Export file',
          onAction: this.handleExportedAction,
        },
      ]
    };
  },
  methods: {
    toggleActive() {
      this.active = !this.active;
    },
    handleImportedAction() {
      console.log('Imported!');
    },
    handleExportedAction() {
      console.log('Exported!');
    }
  },
  template: ` <div>
    <Popover
      :active="active"
      autofocusTarget="first-node"
      v-on:click="toggleActive"
      on-click="toggleActive"
    >
      <Button
        :disclosure="true"
        slot="activator"
        v-on:click="toggleActive"
        on-click="toggleActive"
      > More actions
      </Button>
      <ActionList
        slot="content"
        :items="items"
      >
      </ActionList>
    </Popover>
  </div>`,
});
inAPopover.storyName = 'In a popover';
inAPopover.parameters = {
  docs: {
    source: false,
    transformSource: (source) => {
      const tmpSource = source
        .replace(/<template>\s*/, '')
        .replace(/\s*<\/template>/, '')
        .replace( /(?<=:items=).+/, '"items"')
        .replace( /(?<=:active=).+/, '"active"')
        .replace(/on-click/g, 'v-on:click');
      const fullSource = dedent`
        data() {
          return {
            active: false,
            items: [
              {
                content: 'Import file',
                onAction: this.handleImportedAction,
              },
              {
                content: 'Export file',
                onAction: this.handleExportedAction,
              },
            ]
          };
        },
        methods: {
          toggleActive() {
            this.active = !this.active;
          },
          handleImportedAction() {
            console.log('Imported!');
          },
          handleExportedAction() {
            console.log('Exported!');
          }
        },
        ${tmpSource}
      `;
      return fullSource;
    },
  },
}

export const iconsOrImages = (args, { argTypes }) => ({
  components: { ActionList, Button, Popover },
  data() {
    return {
      active: false,
      items: [
        {
          content: 'Import file',
          image: 'https://user-images.githubusercontent.com/31103446/150456962-80f99435-aa6b-459f-be78-4b89a03417a7.png',
        },
        {
          content: 'Export file',
          icon: ExportMinor,
        },
      ]
    };
  },
  methods: {
    toggleActive() {
      this.active = !this.active;
    },
    handleImportedAction() {
      console.log('Imported!');
    },
    handleExportedAction() {
      console.log('Exported!');
    }
  },
  template: ` <div>
    <Popover
      :active="active"
      autofocusTarget="first-node"
      v-on:click="toggleActive"
      on-click="toggleActive"
    >
      <Button
        :disclosure="true"
        slot="activator"
        v-on:click="toggleActive"
        on-click="toggleActive"
      > More actions
      </Button>
      <ActionList
        slot="content"
        :items="items"
      >
      </ActionList>
    </Popover>
  </div>`,
});
iconsOrImages.storyName = 'With icons or image';
iconsOrImages.parameters = {
  docs: {
    source: false,
    transformSource: (source) => {
      const tmpSource = source
        .replace(/<template>\s*/, '')
        .replace(/\s*<\/template>/, '')
        .replace( /(?<=:items=).+/, '"items"')
        .replace( /(?<=:active=).+/, '"active"')
        .replace(/on-click/g, 'v-on:click');
      const fullSource = dedent`
        import ExportMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ExportMinor.svg';
        data() {
          return {
            active: false,
            items: [
              {
                content: 'Import file',
                image: 'https://user-images.githubusercontent.com/31103446/150456962-80f99435-aa6b-459f-be78-4b89a03417a7.png',
              },
              {
                content: 'Export file',
                icon: ExportMinor,
              },
            ]
          };
        },
        methods: {
          toggleActive() {
            this.active = !this.active;
          },
        },
        ${tmpSource}
      `;
      return fullSource;
    },
  },
}

export const iconAndSuffix = (args, { argTypes }) => ({
  components: { ActionList, Button, Popover, Icon },
  data() {
    return {
      active: false,
      items: [
        {
          active: true,
          content: 'Import file',
          icon: ImportMinor,
          suffixId: 'import',
        },
        {content: 'Export file', icon: ExportMinor},
      ],
      suffixIcon: TickSmallMinor,
    };
  },
  methods: {
    toggleActive() {
      this.active = !this.active;
    },
    handleImportedAction() {
      console.log('Imported!');
    },
    handleExportedAction() {
      console.log('Exported!');
    }
  },
  template: ` <div>
    <Popover
      :active="active"
      autofocusTarget="first-node"
      v-on:click="toggleActive"
      on-click="toggleActive"
    >
      <Button
        :disclosure="true"
        slot="activator"
        v-on:click="toggleActive"
        on-click="toggleActive"
      > More actions
      </Button>
      <ActionList
        slot="content"
        :items="items"
      >
        <Icon
          :source="suffixIcon"
          slot="suffix-import"
        />
      </ActionList>
    </Popover>
  </div>`,
});
iconAndSuffix.storyName = 'With an icon and a suffix';
iconAndSuffix.parameters = {
  docs: {
    source: false,
    transformSource: (source) => {
      const tmpSource = source
        .replace(/<template>\s*/, '')
        .replace(/\s*<\/template>/, '')
        .replace( /(?<=:items=).+/, '"items"')
        .replace( /(?<=:active=).+/, '"active"')
        .replace( /source='(.*)'/, 'source="suffixIcon"')
        .replace(/on-click/g, 'v-on:click');
      const fullSource = dedent`
        import ExportMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ExportMinor.svg';
        import ImportMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ImportMinor.svg';
        import TickSmallMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/TickSmallMinor.svg';
        data() {
          return {
            active: false,
            items: [
              {
                active: true,
                content: 'Import file',
                icon: ImportMinor,
                suffixId: 'import',
              },
              {content: 'Export file', icon: ExportMinor},
            ],
            suffixIcon: TickSmallMinor,
          };
        },
        methods: {
          toggleActive() {
            this.active = !this.active;
          },
        },
        ${tmpSource}
      `;
      return fullSource;
    },
  },
}

export const suffixAndPrefix = (args, { argTypes }) => ({
  components: { ActionList, Button, Popover, Icon },
  data() {
    return {
      active: false,
      items: [
        {
          content: 'Go here',
          prefixId: 'here',
          suffixId: 'here',
        },
        {
          content: 'Or there',
          suffixId: 'there',
        },
      ],
      iconChevronRightMinor: ChevronRightMinor,
    };
  },
  methods: {
    toggleActive() {
      this.active = !this.active;
    },
  },
  template: ` <div>
    <Popover
      :active="active"
      autofocusTarget="first-node"
      v-on:click="toggleActive"
      on-click="toggleActive"
    >
      <Button
        :disclosure="true"
        slot="activator"
        v-on:click="toggleActive"
        on-click="toggleActive"
      > More actions
      </Button>
      <ActionList
        slot="content"
        :items="items"
      >
        <img slot="prefix-here" width="30px" height="30px" src="https://user-images.githubusercontent.com/31103446/150456962-80f99435-aa6b-459f-be78-4b89a03417a7.png"/>
        <Icon :source="iconChevronRightMinor" slot="suffix-here"/>
        <Icon :source="iconChevronRightMinor" slot="suffix-there"/>
      </ActionList>
    </Popover>
  </div>`,
});
suffixAndPrefix.storyName = 'With suffix and prefix';
suffixAndPrefix.parameters = {
  docs: {
    source: false,
    transformSource: (source) => {
      const tmpSource = source
        .replace(/<template>\s*/, '')
        .replace(/\s*<\/template>/, '')
        .replace( /(?<=:items=).+/, '"items"')
        .replace( /(?<=:active=).+/, '"active"')
        .replace( /source='(.*)'/g, 'source="iconChevronRightMinor"')
        .replace(/on-click/g, 'v-on:click');
      const fullSource = dedent`
        import ChevronRightMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ChevronRightMinor.svg';
        data() {
          return {
            active: false,
            items: [
              {
                content: 'Go here',
                prefixId: 'here',
                suffixId: 'here',
              },
              {
                content: 'Or there',
                suffixId: 'there',
              },
            ],
            iconChevronRightMinor: ChevronRightMinor,
          };
        },
        methods: {
          toggleActive() {
            this.active = !this.active;
          },
        },
        ${tmpSource}
      `;
      return fullSource;
    },
  },
}

export const section = (args, { argTypes }) => ({
  components: { ActionList, Button, Popover, Icon },
  data() {
    return {
      active: false,
      sections: [
        {
          title: 'File options',
          items: [
            {content: 'Import file', icon: ImportMinor},
            {content: 'Export file', icon: ExportMinor},
          ],
        },
        {
          title: 'Bulk actions',
          items: [
            {content: 'Edit', icon: EditMinor},
            {content: 'Delete', icon: DeleteMinor},
          ],
        },
      ],
    }
  },
  methods: {
    toggleActive() {
      this.active = !this.active;
    },
  },
  template: ` <div>
    <Popover
      :active="active"
      autofocusTarget="first-node"
      v-on:click="toggleActive"
      on-click="toggleActive"
    >
      <Button
        :disclosure="true"
        slot="activator"
        v-on:click="toggleActive"
        on-click="toggleActive"
      > More actions
      </Button>
      <ActionList
        slot="content"
        :sections="sections"
      >
      </ActionList>
    </Popover>
  </div>`,
});
section.storyName = 'Section';
section.parameters = {
  docs: {
    source: false,
    transformSource: (source) => {
      const tmpSource = source
        .replace(/<template>\s*/, '')
        .replace(/\s*<\/template>/, '')
        .replace( /(?<=:sections=).+/, '"sections"')
        .replace( /(?<=:active=).+/, '"active"')
        .replace( /source='(.*)'/, 'source="suffixIcon"')
        .replace(/on-click/g, 'v-on:click');
      const fullSource = dedent`
        import ExportMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ExportMinor.svg';
        import ImportMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ImportMinor.svg';
        import EditMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/EditMinor.svg';
        import DeleteMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/DeleteMinor.svg';
        data() {
          return {
            active: false,
            sections: [
              {
                title: 'File options',
                items: [
                  {content: 'Import file', icon: ImportMinor},
                  {content: 'Export file', icon: ExportMinor},
                ],
              },
              {
                title: 'Bulk actions',
                items: [
                  {content: 'Edit', icon: EditMinor},
                  {content: 'Delete', icon: DeleteMinor},
                ],
              },
            ],
          };
        },
        methods: {
          toggleActive() {
            this.active = !this.active;
          },
        },
        ${tmpSource}
      `;
      return fullSource;
    },
  },
}

export const destructive = (args, { argTypes }) => ({
  components: { ActionList, Button, Popover },
  data() {
    return {
      active: false,
      sections: [
        {
          title: 'File options',
          items: [
            {
              active: true,
              content: 'Import file',
              icon: ImportMinor,
            },
            {content: 'Export file', icon: ExportMinor},
            {
              destructive: true,
              content: 'Delete file',
              icon: DeleteMinor,
            },
          ],
        },
      ],
    }
  },
  methods: {
    toggleActive() {
      this.active = !this.active;
    },
  },
  template: ` <div>
    <Popover
      :active="active"
      autofocusTarget="first-node"
      v-on:click="toggleActive"
      on-click="toggleActive"
    >
      <Button
        :disclosure="true"
        slot="activator"
        v-on:click="toggleActive"
        on-click="toggleActive"
      > More actions
      </Button>
      <ActionList
        slot="content"
        :sections="sections"
      >
      </ActionList>
    </Popover>
  </div>`,
});
destructive.storyName = 'With destructive item';
destructive.parameters = {
  docs: {
    source: false,
    transformSource: (source) => {
      const tmpSource = source
        .replace(/<template>\s*/, '')
        .replace(/\s*<\/template>/, '')
        .replace( /(?<=:sections=).+/, '"sections"')
        .replace( /(?<=:active=).+/, '"active"')
        .replace( /source='(.*)'/, 'source="suffixIcon"')
        .replace(/on-click/g, 'v-on:click');
      const fullSource = dedent`
        import ExportMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ExportMinor.svg';
        import ImportMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/ImportMinor.svg';
        import DeleteMinor from '!vue-svg-loader!@shopify/polaris-icons/dist/svg/DeleteMinor.svg';
        data() {
          return {
            active: false,
            sections: [
              {
                title: 'File options',
                items: [
                  {
                    active: true,
                    content: 'Import file',
                    icon: ImportMinor,
                  },
                  {content: 'Export file', icon: ExportMinor},
                  {
                    destructive: true,
                    content: 'Delete file',
                    icon: DeleteMinor,
                  },
                ],
              },
            ],
          };
        },
        methods: {
          toggleActive() {
            this.active = !this.active;
          },
        },
        ${tmpSource}
      `;
      return fullSource;
    },
  },
}

export const helpText = (args, { argTypes }) => ({
  components: { ActionList, Button, Popover },
  data() {
    return {
      active: false,
      sections: [
        {
          items: [
            {
              content: 'Blog posts',
              helpText: 'Manage your blog articles',
            },
            {
              content: 'Blogs',
              helpText: 'Manage blogs published to your Online Store',
            },
          ],
        },
      ],
    }
  },
  methods: {
    toggleActive() {
      this.active = !this.active;
    },
  },
  template: ` <div>
    <Popover
      :active="active"
      autofocusTarget="first-node"
      v-on:click="toggleActive"
      on-click="toggleActive"
    >
      <Button
        :disclosure="true"
        slot="activator"
        v-on:click="toggleActive"
        on-click="toggleActive"
      > More actions
      </Button>
      <ActionList
        slot="content"
        :sections="sections"
      >
      </ActionList>
    </Popover>
  </div>`,
});
helpText.storyName = 'With help text';
helpText.parameters = {
  docs: {
    source: false,
    transformSource: (source) => {
      const tmpSource = source
        .replace(/<template>\s*/, '')
        .replace(/\s*<\/template>/, '')
        .replace( /(?<=:sections=).+/, '"sections"')
        .replace( /(?<=:active=).+/, '"active"')
        .replace( /source='(.*)'/, 'source="suffixIcon"')
        .replace(/on-click/g, 'v-on:click');
      const fullSource = dedent`
        data() {
          return {
            active: false,
            sections: [
              {
                items: [
                  {
                    content: 'Blog posts',
                    helpText: 'Manage your blog articles',
                  },
                  {
                    content: 'Blogs',
                    helpText: 'Manage blogs published to your Online Store',
                  },
                ],
              },
            ],
          };
        },
        methods: {
          toggleActive() {
            this.active = !this.active;
          },
        },
        ${tmpSource}
      `;
      return fullSource;
    },
  },
}

# ActionList

Action lists render a list of actions or selectable options. This component is usually placed inside a popover container to create a dropdown menu or to let merchants select from a list of options.

For Icon Usage, use the [Icon component.](/docs/components-images-and-icons-icon--icon)

<br/><br/>

### In a Popover

<Canvas style={{ backgroundColor: '#f6f6f7' }}>
  <Story story={inAPopover} height="250px" inline={false} />
</Canvas>

### With icons or image

<Canvas style={{ backgroundColor: '#f6f6f7' }}>
  <Story story={iconsOrImages} height="250px" inline={false} />
</Canvas>

### With an icon and a suffix

<Canvas style={{ backgroundColor: '#f6f6f7' }}>
  <Story story={iconAndSuffix} height="250px" inline={false} />
</Canvas>

### With prefix and suffix

<Canvas style={{ backgroundColor: '#f6f6f7' }}>
  <Story story={suffixAndPrefix} height="250px" inline={false} />
</Canvas>

### Section

<Canvas style={{ backgroundColor: '#f6f6f7' }}>
  <Story story={section} height="280px" inline={false} />
</Canvas>

### With destructive item

<Canvas style={{ backgroundColor: '#f6f6f7' }}>
  <Story story={destructive} height="250px" inline={false} />
</Canvas>

### With help text

<Canvas style={{ backgroundColor: '#f6f6f7' }}>
  <Story story={helpText} height="250px" inline={false} />
</Canvas>

### Example
<Canvas>
  <Story name="ActionList" height="40px">
    {Template.bind({})}
  </Story>
</Canvas>

<ArgsTable story="ActionList" />
